---
title: Secrets in Tanzu Build Service
owner: Build Service Team
---

Tanzu Build Service uses standard Kubernetes secrets to store credentials for registries and git based repositories. These credentials include the following:

* Git credentials added to namespaces and projects
* Registry credentials added to namespaces and projects
* Registry credentials provided during installation

## <a id='encrypt-secrets'></a> Encrypting Secrets at Rest

Because Tanzu Build Service uses standard Kubernetes secrets, administrators may configure the cluster to encrypt secrets at rest. For more information, see the following link: https://kubernetes.io/docs/tasks/administer-cluster/encrypt-data/

## <a id='sync-secrets'></a> Synchronizing Registry Secrets to Namespaces

To allow you to use Cluster Builders from private registries, Tanzu Build Service provides functionality to synchronize secrets across namespaces.
This feature is applicable in the following cases:
    * You have installed Tanzu Build Service to a private registry and do not wish to make Cluster Builders imported by `kp` publicly readable.
    * You have used `kp` to create a Cluster Builder in a private registry and do not wish to make it publicly readable.
 
Synchronized secrets are attached to build pods as `imagePullSecrets` so that the Cluster Builder Image can be pulled at build time.

<p class='note'><strong>Note:</strong> Synchronizing secrets with write access is not recommended. Instead, create and synchronize read-only secrets.</p> 

## <a id='manage-sync'></a> Managing Secret Synchronization

Currently, the `kp` CLI does not support adding and removing synchronized secrets. However, this may be achieved by using the `kubectl` CLI.

### <a id='start-sync'></a> Start Synchronizing a Secret

To start synchronizing a secret to all namespaces with builds, use `kubectl` to create a docker-registry (Dockercfg or DockerConfigJson) secret in the `build-service` namespace with the following label: `com.vmware.tanzu.buildservice.sync=true`.
For example:
```
apiVersion: v1
data:
  .dockerconfigjson: <SECRET DATA>
kind: Secret
metadata:
  labels:
    com.vmware.tanzu.buildservice.sync: "true"
  name: my-synced-secret
  namespace: build-service
type: kubernetes.io/dockerconfigjson

```

### <a id='update-sync'></a> Updating a Synchronized Secret

To update a secret and roll-out those changes to all projects, simply update the secret(s) with the `com.vmware.tanzu.buildservice.sync=true` label located in the `build-service` namespace.

### <a id='stop-sync'></a> Stop Synchronizing a Secret

To stop synchronizing a secret, delete the secret from the `build-service` namespace or remove the `com.vmware.tanzu.buildservice.sync=true` label from the secret located in the `build-service` namespace.
